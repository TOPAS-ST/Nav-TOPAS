OBJECT Report 50075 TOPAS-Auftragsbest„tigung -Log
{
  OBJECT-PROPERTIES
  {
    Date=17.02.15;
    Time=12:34:35;
    Modified=Yes;
    Version List=Beleg Žnderungsbest„tigung --> 50098 !!;
  }
  PROPERTIES
  {
    TopMargin=500;
    BottomMargin=0;
    LeftMargin=1700;
    RightMargin=100;
    UseSystemPrinter=Yes;
    OnInitReport=BEGIN
                   FIBUEinrichtung.GET;
                   AnzKopien:=1;
                 END;

    OnPreReport=BEGIN
                  AnzKopien_sich:=AnzKopien;
                END;

    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table36;
        DataItemTableView=SORTING(Document Type,No.)
                          WHERE(Document Type=CONST(Order),
                                Location Code=FILTER(ZENT|KONSI));
        NewPagePerRecord=Yes;
        PrintOnlyIfDetail=Yes;
        ReqFilterHeadingML=DEU=Verkaufsauftrag;
        OnPreDataItem=BEGIN
                        Firmendaten.GET;
                        Firmendaten.CALCFIELDS("ISO Logo");
                        FormatAdr.Company(FirmaAdr,Firmendaten);
                      END;

        OnAfterGetRecord=BEGIN
                           //25.04.2012-ST
                           CurrReport.LANGUAGE := language.GetLanguageID("Language Code");

                           lead_free_text0 := '';
                           lead_free_text1 := '';
                           lead_free_text2 := '';
                           lead_text := '';

                           IF "Sales Header"."AB via EMail" THEN AnzKopien:=0 ELSE AnzKopien:=AnzKopien_sich;


                           IF "Salesperson Code" = '' THEN BEGIN
                             CLEAR(VerkEinkPerson);
                             Verk„uferText := '';
                           END ELSE BEGIN
                             VerkEinkPerson.GET("Salesperson Code");
                             Verk„uferText := 'Verk„ufer';
                           END;
                           IF "Your Reference" = '' THEN
                             ReferenzText := ''
                           ELSE
                             ReferenzText := FIELDNAME("Your Reference");
                           IF "VAT Registration No." = '' THEN
                             MWStNrText := ''
                           ELSE
                             MWStNrText := FIELDNAME("VAT Registration No.");


                           //IF verkaufskopf.W„hrungscode = '' THEN BEGIN
                           //  FIBUEinrichtung.TESTFIELD(Mandantenw„hrungscode);
                           //  TotalText := STRSUBSTNO('Total %1',FIBUEinrichtung.Mandantenw„hrungscode);
                           //  TotalInklMWStText := STRSUBSTNO('Total %1 inkl. MWSt',FIBUEinrichtung.Mandantenw„hrungscode);
                           //END ELSE BEGIN
                           //  TotalText := STRSUBSTNO('Total %1',W„hrungscode);
                           //  TotalInklMWStText := STRSUBSTNO('Total %1 inkl. MWSt',W„hrungscode);
                           //END;
                           FormatAdr.SalesHeaderBillTo(DebAdr,"Sales Header");
                           FormatAdr.SalesHeaderSellTo(VerkAdr,"Sales Header");
                           IF "Payment Terms Code" = '' THEN
                             ZlgBed.INIT
                           ELSE
                             ZlgBed.GET("Payment Terms Code");
                           IF "Shipment Method Code" = '' THEN
                             LieferBed.INIT
                           ELSE
                             LieferBed.GET("Shipment Method Code");

                           FormatAdr.SalesHeaderShipTo(LieferAnAdr,"Sales Header");
                           LiefAdrAnzeigen := "Sell-to Customer No." <> "Bill-to Customer No.";
                           FOR i := 1 TO ARRAYLEN(LieferAnAdr) DO
                             IF (LieferAnAdr[i] <> VerkAdr[i]) OR (DebAdr[i] <> VerkAdr[i]) THEN
                               LiefAdrAnzeigen := TRUE;

                           IF "Currency Code" = '' THEN
                           BEGIN
                           waehrung:='[ '+'°'+' ]';
                           waehrung2:='EUR';
                           END
                           ELSE
                           BEGIN
                           waehrung:='[ '+"Currency Code"+' ]';
                           waehrung2:="Currency Code";
                           END;

                           v_FER_SPL:=FALSE;
                         END;

        ReqFilterFields=No.,Sell-to Customer No.,Order Date;
        CalcFields=AB via EMail;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table18;
        DataItemVarName=Debito;
        OnAfterGetRecord=BEGIN
                           {
                           IF (("Country/Region Code" <> 'DE') AND("Country/Region Code" <>'AT') AND ("Country/Region Code" <>'CH')) THEN
                           BEGIN
                           CurrReport.LANGUAGE(1033); // Deutscher L„ndercode
                           END
                           ELSE
                           BEGIN
                           CurrReport.LANGUAGE(1031); // Englischer L„ndercode  (ENU Englisch(USA))
                           END;
                           }

                           // TOPAS Rahmenauftrag
                           rahmenauftragsnummer:='';
                           rahmen:=FALSE;
                           // ende

                           IF Steuernummer= '' THEN
                             var_steuernr1 := ''
                           ELSE
                             IF CurrReport.LANGUAGE = 1031 THEN
                               BEGIN
                                  var_steuernr1 :='Ihre Steuernummer:';
                               END
                              ELSE
                               BEGIN
                                  var_steuernr1 :='';
                               END;

                           IF "Sales Header"."VAT Registration No."= '' THEN
                              var_steuernr2 := ''
                           ELSE
                             IF CurrReport.LANGUAGE = 1031 THEN
                               BEGIN
                                  var_steuernr2 :='USt-IdNr.';
                               END
                              ELSE
                               BEGIN
                                  var_steuernr2 :='Tax Number';
                               END;


                           IF CurrReport.LANGUAGE = 1031 THEN
                              BEGIN
                                  IF "Sales Header"."Currency Code" = '' THEN BEGIN
                                     FIBUEinrichtung.TESTFIELD("LCY Code");
                                     TotalText :='Total';
                                     TotalInklMWStText :='Total inkl. MWSt';
                           //          TotalText := STRSUBSTNO('Total %1',FIBUEinrichtung."LCY Code");
                           //          TotalInklMWStText := STRSUBSTNO('Total %1 inkl. MWSt',FIBUEinrichtung."LCY Code");
                                  END ELSE BEGIN
                                     TotalText :='Total';
                                     TotalInklMWStText :='Total inkl. MWSt';
                           //          TotalText := STRSUBSTNO('Total %1',"Sales Header"."Currency Code");
                           //          TotalInklMWStText := STRSUBSTNO('Total %1 inkl. MWSt',"Sales Header"."Currency Code");
                                  END;
                              END
                              ELSE
                              BEGIN
                                  IF "Sales Header"."Currency Code" = '' THEN BEGIN
                                     FIBUEinrichtung.TESTFIELD("LCY Code");
                                     TotalText :='Total';
                                     TotalInklMWStText :='Total incl. V.A.T.';
                           //          TotalText := STRSUBSTNO('Total %1',FIBUEinrichtung."LCY Code");
                           //          TotalInklMWStText := STRSUBSTNO('Total %1 incl. V.A.T.',FIBUEinrichtung."LCY Code");
                                  END ELSE BEGIN
                                     TotalText :='Total';
                                     TotalInklMWStText :='Total incl. V.A.T.';
                           //          TotalText := STRSUBSTNO('Total %1',"Sales Header"."Currency Code");
                           //          TotalInklMWStText := STRSUBSTNO('Total %1 incl. V.A.T.',"Sales Header"."Currency Code");
                                  END;
                              END;
                         END;

        DataItemLinkReference=Sales Header;
        DataItemLink=No.=FIELD(Sell-to Customer No.);
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table13;
        OnAfterGetRecord=BEGIN
                             IF CurrReport.LANGUAGE = 1031 THEN
                               BEGIN
                                  ansp_telefon:="Salesperson/Purchaser"."Phone No.";
                                  ansp_fax:="Salesperson/Purchaser"."Fax no.";
                                  ansp_anrede :="Salesperson/Purchaser".Ansprech;
                               END
                              ELSE
                               BEGIN
                                  ansp_telefon:="Salesperson/Purchaser".Tel_international;
                                  ansp_fax:="Salesperson/Purchaser".Fax_international;
                                  ansp_anrede :="Salesperson/Purchaser".Ansprech_eng;
                               END;
                         END;

        DataItemLink=Code=FIELD(Betreuer Innendienst);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18800;
            SectionHeight=0;
          }
          CONTROLS
          {
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table291;
        DataItemLinkReference=Sales Header;
        DataItemLink=Code=FIELD(Shipping Agent Code);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18800;
            SectionHeight=0;
          }
          CONTROLS
          {
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        NewPagePerRecord=Yes;
        DataItemVarName=KopieSchleife;
        OnPreDataItem=BEGIN
                        AnzSchleifen := ABS(AnzKopien) + 1;
                        KopieText := '';
                        SETRANGE(Number,1,AnzSchleifen);
                        sum_restauftragsbestand:=0;
                        sum_mwstbetrag:=0;
                      END;

        OnAfterGetRecord=BEGIN
                           sum_restauftragsbestand:=0;
                           sum_mwstbetrag:=0;
                           CLEAR(VerkZeile2);
                           CLEAR(VerkBuchen);
                           VerkBuchen.GetSalesLines("Sales Header",VerkZeile2,0);

                           IF Number > 1 THEN
                             BEGIN
                               CurrReport.PAPERSOURCE(1);
                             END
                             ELSE
                             BEGIN
                                 CurrReport.PAPERSOURCE(3);
                             END;

                           "Printer selection".RESET;
                           "Printer selection".SETFILTER("Printer selection"."User ID",'%1',USERID);
                           "Printer selection".SETFILTER("Printer selection"."Report ID",'%1',50075);
                           IF "Printer selection".FINDFIRST() THEN
                             BEGIN
                               IF ("Printer selection"."Printer Name" <> 'PDFCreator') AND ("Sales Header"."AB via EMail" = TRUE) THEN
                                 BEGIN
                                     pdf := TRUE;
                                 END
                                 ELSE
                                 BEGIN
                                     pdf := FALSE;
                                 END;
                             END
                             ELSE
                             BEGIN
                               pdf := FALSE;
                             END;

                           FOR k:=1 TO 9 DO
                             BEGIN
                               andruck[k] := '';
                             END;

                           n„chste_lief_jahr :='';
                           n„chste_lief_woche := '';

                           counter := 0;

                           kunde.GET("Sales Header"."Sell-to Customer No.");
                           IF ((Number > 1) AND (pdf = FALSE)) OR (pdf = TRUE) THEN
                             BEGIN
                             CurrReport.PAPERSOURCE(1);
                             KopieText := 'skopie';
                             IF kunde."AB vor Wandlung" THEN andruck[AndruckFeldPrfen] := 'Achtung erst AB dann Wandeln !!!';
                             IF kunde."AB via EMail" THEN
                               BEGIN
                                 andruck[AndruckFeldPrfen] := 'Achtung via E-Mail versenden !!!';
                                 andruck[AndruckFeldPrfen] := "Sales Header"."AB via EMail-Adresse";
                                 andruck[AndruckFeldPrfen] := 'Erledigt von ..............'  ;
                               END;
                             IF kunde."AB via Fax" THEN
                               BEGIN
                                 andruck[AndruckFeldPrfen] := 'Achtung via Fax versenden !!!';
                                 andruck[AndruckFeldPrfen] := 'Erledigt von ..............'  ;
                               END;
                             IF kunde."AB nur best„tigt" THEN
                               BEGIN
                                 andruck[AndruckFeldPrfen] := 'Keine AB ohne Termin !!!';
                               END;
                             IF kunde."Best„tigung via Internet" THEN
                               BEGIN
                                 andruck[AndruckFeldPrfen] := 'Best. per Internet (Vertrieb)!';
                                 andruck[AndruckFeldPrfen] := 'Termin eingehend beim Kunden';
                                 andruck[AndruckFeldPrfen] := 'Erledigt von ..............'  ;
                               END;
                             IF kunde."abw. Rechnungsadresse" THEN
                               BEGIN
                                 andruck[AndruckFeldPrfen] := 'abw. Rechnungsadresse berprfen !!!';
                               END;
                             IF kunde."AB nur bei Abweichungen" = TRUE THEN
                               BEGIN
                                 andruck[AndruckFeldPrfen] := 'AB nur bei Abweichungen !!!';
                               END;
                             IF "Sales Header"."Location Code"='KONSI' THEN
                               BEGIN
                                 andruck[AndruckFeldPrfen] := 'Konsignationslager';
                               END;
                             IF "Sales Header"."Nicht rechnen" = TRUE THEN
                               BEGIN
                                 andruck[AndruckFeldPrfen] := 'Nicht rechnen, ist fix !!!';
                               END;
                             IF "Sales Header".W„hrungsabgleich = TRUE THEN
                               BEGIN
                                 andruck[AndruckFeldPrfen] := 'WŽ berprfen, +/- 3% !';
                               END;

                             IF STRPOS("Sales Header"."Payment Terms Code",'SOR') <> 0 THEN
                               andruck[9] := 'SOR';

                           //  TOPAS neu UB 14.06.2010  KW fr Ablage bestimmen
                               n„chste_lief_tab.RESET;
                               n„chste_lief_tab.SETFILTER("Document No.",'%1',"Sales Header"."No.");
                               n„chste_lief_tab.SETFILTER(Type,'%1',n„chste_lief_tab.Type::Item);
                               n„chste_lief_tab.SETFILTER("Outstanding Quantity",'>%1',0);
                               n„chste_lief_tab.SETCURRENTKEY("Document Type",Type,"Promised Delivery Date");
                               n„chste_lief_jahr:='';
                               n„chste_lief_woche:='';
                               IF (n„chste_lief_tab.FINDFIRST) AND (n„chste_lief_tab."Promised Delivery Date" <> 0D) THEN
                                 BEGIN
                                   n„chste_lief_woche:='KW '+FORMAT(DATE2DWY(n„chste_lief_tab."Promised Delivery Date", 2));
                                   n„chste_lief_jahr:=FORMAT(DATE2DWY(n„chste_lief_tab."Promised Delivery Date", 3));
                                   IF n„chste_lief_tab."Promised Delivery Date" = (31122053D) THEN
                                     BEGIN
                                       n„chste_lief_jahr := '';
                                       n„chste_lief_woche := 'Auf Abruf';
                                     END;

                                   IF n„chste_lief_tab.FINDLAST THEN
                                     BEGIN
                                       IF n„chste_lief_tab."Promised Delivery Date" = (31122055D) THEN
                                         BEGIN
                                           n„chste_lief_jahr := '';
                                           n„chste_lief_woche := 'Termin folgt';
                                         END;
                                     END;
                                 END;
                             END;


                             IF CurrReport.LANGUAGE = 1031 THEN
                               BEGIN
                                  IF (Number > 1) OR (pdf = TRUE) THEN KopieText := 'skopie';
                                  CurrReport.PAGENO := 1;
                                  IF "Sales Header"."Document Date" > "Sales Header"."Order Date" THEN
                                     BEGIN
                                       „nderung := 'Žnderungs-';
                                     END ELSE
                                     BEGIN
                                       „nderung :='';
                                     END;
                               END
                              ELSE
                               BEGIN
                                  IF (Number > 1) OR (pdf = TRUE)THEN KopieText := ' Copy';
                                  CurrReport.PAGENO := 1;
                                  IF "Sales Header"."Document Date" > "Sales Header"."Order Date" THEN
                                     BEGIN
                                       „nderung := 'Change';
                                     END ELSE
                                     BEGIN
                                       „nderung :='';
                                     END;

                               END;


                           IF (("Sales Header"."Shipment Method Code"='ACCOUNT') OR ("Sales Header"."Shipment Method Code"='ACC-ENG')
                           OR ("Sales Header"."Shipment Method Code"='EXW_1')) THEN
                             BEGIN
                            //   Account:="Sales Header".Spediteuraccount;
                                Account:="Shipping Agent".Name+' / '+"Sales Header".Spediteuraccount;
                             END ELSE
                               BEGIN
                                 Account:="Shipping Agent".Name
                               END;

                           IF ((Number > 1) AND ("Sales Header"."Keine AB an Kunden")) OR ((pdf=TRUE) AND ("Sales Header"."Keine AB an Kunden")) THEN
                             andruck[AndruckFeldPrfen] := 'Keine AB an Kunden!!!';
                         END;

        OnPostDataItem=BEGIN
                         IF NOT CurrReport.PREVIEW THEN
                           VerkDruckZ„hler.RUN("Sales Header");

                         // TOPAS Rahmenauftrag
                         IF rahmen THEN
                           BEGIN
                             rahmenauftr„ge.SETFILTER("No.",rahmenauftragsnummer);
                             MESSAGE('Rahmenauftrag mit der Nr.:'+rahmenauftragsnummer+' manuell drucken!') ;

                             //REPORT.RUN(50114,FALSE,FALSE,rahmenauftr„ge);
                           END;

                         // ende
                       END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=SeiteSchleife;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18800;
            SectionHeight=13000;
            OnPreSection=BEGIN
                           IF CurrReport.LANGUAGE = 1031 THEN
                              BEGIN
                                seite:=STRSUBSTNO('Seite %1',FORMAT(CurrReport.PAGENO))   ;
                              END
                              ELSE
                              BEGIN
                                seite:=STRSUBSTNO('Page %1',FORMAT(CurrReport.PAGENO))   ;
                              END;
                         END;

          }
          CONTROLS
          {
            { 98  ;TextBox      ;592  ;4979 ;8300 ;423  ;FontSize=10;
                                                         SourceExpr=VerkAdr[1] }
            { 100 ;TextBox      ;592  ;5379 ;8300 ;423  ;FontSize=10;
                                                         SourceExpr=VerkAdr[2] }
            { 108 ;TextBox      ;592  ;5779 ;8300 ;423  ;FontSize=10;
                                                         SourceExpr=VerkAdr[3] }
            { 116 ;TextBox      ;592  ;6179 ;8300 ;423  ;FontSize=10;
                                                         SourceExpr=VerkAdr[4] }
            { 131 ;TextBox      ;592  ;6579 ;8300 ;423  ;FontSize=10;
                                                         SourceExpr=VerkAdr[5] }
            { 142 ;TextBox      ;592  ;6979 ;8300 ;423  ;FontSize=10;
                                                         SourceExpr=VerkAdr[6] }
            { 146 ;TextBox      ;592  ;7379 ;8300 ;400  ;FontSize=10;
                                                         SourceExpr=VerkAdr[7] }
            { 147 ;TextBox      ;592  ;7779 ;8300 ;423  ;FontSize=10;
                                                         SourceExpr=VerkAdr[8] }
            { 23  ;TextBox      ;17156;10500;1124 ;423  ;HorzAlign=Right;
                                                         FontSize=7;
                                                         SourceExpr=seite }
            { 7   ;Shape        ;11900;11300;6400 ;1400  }
            { 28  ;TextBox      ;16600;12000;1300 ;500  ;FontSize=9;
                                                         SourceExpr=FORMAT("Sales Header"."Document Date",0,1) }
            { 27  ;TextBox      ;14300;12000;1900 ;500  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr="Sales Header"."Bill-to Customer No." }
            { 5   ;Label        ;14300;11500;2200 ;400  ;Name=Kundenummer;
                                                         CaptionML=[DEU=Kundennummer;
                                                                    ENU=Customer] }
            { 6   ;Label        ;16600;11500;900  ;400  ;Name=Datum;
                                                         CaptionML=[DEU=Datum;
                                                                    ENU=Date] }
            { 36  ;TextBox      ;12100;12000;2100 ;500  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr="Sales Header"."No." }
            { 4   ;Label        ;12100;11500;2100 ;400  ;Name=Auftragsnummer;
                                                         CaptionML=[DEU=Auftragsnummer;
                                                                    ENU=Our Reference] }
            { 11  ;TextBox      ;10200;10200;2600 ;800  ;FontSize=16;
                                                         SourceExpr=KopieText }
            { 30  ;TextBox      ;8900 ;12000;2900 ;500  ;FontSize=9;
                                                         SourceExpr="Sales Header"."VAT Registration No." }
            { 10  ;Label        ;5300 ;10200;5500 ;800  ;Name=Auftragsbest„tigung;
                                                         FontSize=16;
                                                         CaptionML=[DEU=Auftragsbest„tigung;
                                                                    ENU=Order Confirmation] }
            { 18  ;TextBox      ;8900 ;11500;2000 ;400  ;FontSize=7;
                                                         SourceExpr=var_steuernr2 }
            { 12  ;TextBox      ;6700 ;12000;2200 ;500  ;FontSize=9;
                                                         AutoEnter=No;
                                                         AssistEdit=No;
                                                         SourceExpr=Debito."Our Account No.";
                                                         TableRelation=Customer }
            { 13  ;Label        ;6700 ;11500;2000 ;400  ;Name=Lieferanten-Nr.;
                                                         CaptionML=[DEU=Lieferanten-Nr.;
                                                                    ENU=Account Code] }
            { 38  ;TextBox      ;0    ;12000;6700 ;500  ;FontSize=9;
                                                         SourceExpr="Sales Header"."External Document No."+' '+"Sales Header"."Your Reference" }
            { 9   ;Label        ;0    ;11500;2600 ;400  ;Name=Ihre Auftragsangaben;
                                                         CaptionML=[DEU=Ihre Auftragsangaben;
                                                                    ENU=Customer Ref.] }
            { 60  ;TextBox      ;5300 ;9500 ;5000 ;700  ;HorzAlign=Center;
                                                         FontSize=16;
                                                         SourceExpr=„nderung }
            { 134 ;Label        ;13000;8100 ;4200 ;300  ;Name=Steuer-Nr.:   25/202/35327;
                                                         FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=[DEU=Steuer-Nr.:   25/202/35327;
                                                                    ENU=TAX No.:   25/202/35327] }
            { 135 ;Label        ;13000;8400 ;4200 ;300  ;Name=USt.-ID.-Nr.: DE115651057;
                                                         FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=[DEU=USt.-ID.-Nr.: DE115651057;
                                                                    ENU=USt.-ID.-No.: DE115651057] }
            { 140 ;Label        ;592  ;4379 ;4200 ;300  ;Name=[TOPAS electronic GmbH, ];
                                                         FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=No;
                                                         CaptionML=DEU=TOPAS electronic GmbH, }
            { 141 ;Label        ;3578 ;4378 ;2200 ;300  ;Name=Postfach 11 04 11,;
                                                         FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=No;
                                                         CaptionML=DEU=Postfach 11 04 11, }
            { 144 ;Label        ;5840 ;4379 ;2930 ;300  ;Name=30100 Hannover;
                                                         FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=No;
                                                         CaptionML=[DEU=30100 Hannover;
                                                                    ENU=30100 Hannover, Germany] }
            { 185 ;TextBox      ;5200 ;6500 ;8700 ;600  ;BorderColor=0;
                                                         FontSize=15;
                                                         FontBold=Yes;
                                                         SourceExpr=andruck[3] }
            { 186 ;TextBox      ;5200 ;7100 ;8700 ;600  ;FontSize=15;
                                                         FontBold=Yes;
                                                         SourceExpr=andruck[4] }
            { 187 ;TextBox      ;5200 ;7700 ;8700 ;600  ;FontSize=15;
                                                         FontBold=Yes;
                                                         SourceExpr=andruck[5] }
            { 188 ;TextBox      ;5200 ;8300 ;8721 ;600  ;FontSize=15;
                                                         FontBold=Yes;
                                                         SourceExpr=andruck[6] }
            { 194 ;TextBox      ;6700 ;12600;2200 ;400  ;FontSize=7;
                                                         SourceExpr=var_steuernr1 }
            { 195 ;TextBox      ;8900 ;12500;2900 ;500  ;FontSize=9;
                                                         SourceExpr=Debito.Steuernummer }
            { 207 ;TextBox      ;5200 ;8900 ;8740 ;600  ;FontSize=15;
                                                         FontBold=Yes;
                                                         SourceExpr=andruck[7] }
            { 1140000;TextBox   ;13000;10275;4200 ;300  ;SourceExpr="Salesperson/Purchaser"."E-Mail" }
            { 1140001;TextBox   ;13000;9075 ;4200 ;300  ;SourceExpr=ansp_anrede }
            { 1140002;TextBox   ;13000;9375 ;4200 ;300  ;SourceExpr="Salesperson/Purchaser"."first name" + ' ' +"Salesperson/Purchaser".Name }
            { 1140003;TextBox   ;13800;9675 ;3400 ;300  ;SourceExpr=ansp_telefon }
            { 1140004;TextBox   ;13800;9975 ;3400 ;300  ;SourceExpr=ansp_fax }
            { 1140005;Label     ;13000;9675 ;800  ;300  ;CaptionML=[DEU=Tel. :;
                                                                    ENU=Phone:] }
            { 1140006;Label     ;13000;9975 ;800  ;300  ;CaptionML=[DEU=Fax :;
                                                                    ENU=Fax :] }
            { 1140007;TextBox   ;5179 ;5947 ;8699 ;600  ;FontSize=15;
                                                         FontBold=Yes;
                                                         SourceExpr=andruck[2] }
            { 1140009;TextBox   ;5200 ;5400 ;8699 ;600  ;FontSize=15;
                                                         FontBold=Yes;
                                                         SourceExpr=andruck[1] }
            { 1140014;TextBox   ;14314;0    ;2800 ;720  ;FontSize=14;
                                                         SourceExpr=n„chste_lief_woche }
            { 1140015;TextBox   ;14314;688  ;2800 ;721  ;FontSize=14;
                                                         SourceExpr=n„chste_lief_jahr }
            { 1140017;TextBox   ;0    ;9900 ;2400 ;1100 ;FontSize=24;
                                                         FontBold=Yes;
                                                         SourceExpr=andruck[9] }
            { 1140025;Label     ;13000;8700 ;4200 ;300  ;Name=WEEE-Reg.-Nr.: DE 69202523;
                                                         FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=[DEU=WEEE-Reg.-Nr.: DE 69202523;
                                                                    ENU=WEEE-Reg.-Nr.: DE 69202523] }
            { 1140027;Label     ;2855 ;1707 ;9830 ;400  ;FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=No;
                                                         CaptionML=[DEU=Gesch„ftsfhrer: Ulf Zell, Joachim Maaá, Gert von Engelhardt, Thomas Fortmann;
                                                                    ENU=CEO: Ulf Zell, Joachim Maaá, Gert von Engelhardt, Thomas Fortmann] }
            { 1140028;Label     ;9885 ;1281 ;2467 ;400  ;FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=No;
                                                         CaptionML=[DEU=30163 Hannover;
                                                                    ENU="30163 Hannover "] }
            { 1140029;Label     ;6583 ;1283 ;3433 ;400  ;FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=No;
                                                         CaptionML=[DEU=Groáer Kolonnenweg 18C3,;
                                                                    ENU=Grosser Kolonnenweg 18C3,] }
            { 1140030;Label     ;2855 ;2107 ;4200 ;400  ;Name=Amtsgericht Hannover HRB 1838;
                                                         FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=No }
            { 1140031;Label     ;0    ;1249 ;6600 ;400  ;FontName=Arial;
                                                         FontSize=9;
                                                         FontBold=No;
                                                         CaptionML=[DEU="TOPAS electronic Vertriebsgesellschaft mbH, ";
                                                                    ENU="TOPAS electronic Vertriebsgesellschaft mbH   "] }
            { 1140032;Label     ;19   ;2107 ;2700 ;400  ;FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=No;
                                                         CaptionML=[DEU=Fax. (0511) 9 68 64-64;
                                                                    ENU=Fax. +49 511- 9 68 64-64] }
            { 1140033;Label     ;19   ;1707 ;2700 ;400  ;FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=No;
                                                         CaptionML=[DEU="Tel. (0511) 9 68 64-0 ";
                                                                    ENU="Phone +49 511- 9 68 64-0  "] }
            { 1140018;Label     ;13000;3000 ;4200 ;300  ;Name=Deutsche Bank AG, Hannover;
                                                         FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=Yes }
            { 1140019;Label     ;13000;3300 ;4200 ;300  ;Name=USD-Kto 0305615;
                                                         FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=No;
                                                         CaptionML=DEU=EUR- und USD-Konto: }
            { 1140020;Label     ;13000;3600 ;4200 ;300  ;Name=SWIFT-BIC.: DEUTDE2HXXX;
                                                         FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=No }
            { 1140021;Label     ;13000;3900 ;4200 ;300  ;Name=IBAN: DE62250700700030561500;
                                                         FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=No }
            { 1140022;Label     ;13000;4275 ;4200 ;300  ;Name=Dresdener Bank AG, Hannover;
                                                         FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=DEU=Commerzbank AG, Hannover }
            { 1140023;Label     ;13000;4575 ;4200 ;300  ;Name=DM-Kto 0770566900 BLZ 25080020;
                                                         FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=No;
                                                         CaptionML=DEU=EUR-, USD- und JPY-Konto: }
            { 1140024;Label     ;13000;4875 ;4200 ;300  ;Name=SWIFT-BIC.: DRESDEFF250;
                                                         FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=No }
            { 1140034;Label     ;13000;5175 ;4200 ;300  ;Name=IBAN: DE30250800200770566900;
                                                         FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=No }
            { 1140035;Label     ;13000;5550 ;4200 ;300  ;Name=Stadtsparkasse Barsinghausen;
                                                         FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=Yes }
            { 1140036;Label     ;13000;5850 ;4200 ;300  ;Name=EUR-Konto:;
                                                         FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=No }
            { 1140037;Label     ;13000;6150 ;4200 ;300  ;Name=Swift-BIC.: NOLADE21BAH;
                                                         FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=No }
            { 1140038;Label     ;13000;6450 ;4200 ;300  ;Name=IBAN: DE68251512700000106054;
                                                         FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=No }
            { 1140039;Label     ;13000;6825 ;4200 ;300  ;Name=Postbank Hannover;
                                                         FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=Yes }
            { 1140040;Label     ;13000;7125 ;4200 ;300  ;Name=EUR-Konto:;
                                                         FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=No }
            { 1140041;Label     ;13000;7425 ;4200 ;300  ;Name=SWIFT-BIC.: PBNKDEFFXXX;
                                                         FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=No }
            { 1140042;Label     ;13000;7725 ;4200 ;300  ;Name=IBAN: DE24250100300379307301;
                                                         FontName=Arial;
                                                         FontSize=7;
                                                         FontBold=No }
            { 1140043;PictureBox;9145 ;2571 ;3100 ;2000 ;SourceExpr=Firmendaten."ISO Logo" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=18800;
            SectionHeight=1200;
          }
          CONTROLS
          {
            { 14  ;Label        ;0    ;800  ;18800;400  ;HorzAlign=Center;
                                                         FontName=<Helvetica>;
                                                         FontSize=6;
                                                         CaptionML=[DEU=Eigentumsvorbehalt: Insbesondere weisen wir darauf hin, dass die Ware gem„á unserer allgemeinen Gesch„ftsbedingungen bis zur Zahlung in voller H”he unser Eigentum bleibt.;
                                                                    ENU=TOPAS shall retain title to goods until it has received payment in full.] }
            { 15  ;Label        ;0    ;500  ;18800;400  ;HorzAlign=Center;
                                                         FontName=arial;
                                                         FontSize=6;
                                                         CaptionML=[DEU=Fr die Ausfhrung dieses Auftrages gelten unsere allgemeinen Gesch„ftsbedingungen;
                                                                    ENU=The execution of orders are subject to our standard terms and condition of sale.] }
            { 16  ;Shape        ;0    ;400  ;18800;300  ;ShapeStyle=HorzLine }
            { 17  ;Label        ;0    ;0    ;18800;600  ;HorzAlign=Center;
                                                         FontName=<Helvetica>;
                                                         FontSize=9;
                                                         CaptionML=DEU=www.topas.de }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table37;
        DataItemTableView=SORTING(Document Type,Document No.,Line No.);
        PrintOnlyIfDetail=Yes;
        OnPreDataItem=BEGIN
                        CurrReport.BREAK;
                      END;

        DataItemLinkReference=Sales Header;
        DataItemLink=Document Type=FIELD(Document Type),
                     Document No.=FIELD(No.);
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=RundungsRahmen;
        OnPreDataItem=BEGIN
                        MWSTBetragZeile.DELETEALL;
                        MehrZeilen := VerkZeile2.FIND('+');
                        WHILE MehrZeilen AND (VerkZeile2.Description = '') AND
                              (VerkZeile2."No." = '') AND (VerkZeile2.Quantity = 0) AND
                              (VerkZeile2.Amount = 0)
                        DO
                          MehrZeilen := VerkZeile2.NEXT(-1) <> 0;
                        IF NOT MehrZeilen THEN
                          CurrReport.BREAK;
                        VerkZeile2.SETRANGE("Line No.",0,VerkZeile2."Line No.");
                        SETRANGE(Number,1,VerkZeile2.COUNT);
                        CurrReport.CREATETOTALS(VerkZeile2."Outstanding Amount",VerkZeile2."Amount Including VAT",VerkZeile2."Inv. Discount Amount");
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number = 1 THEN
                             VerkZeile2.FIND('-')
                           ELSE
                             VerkZeile2.NEXT;
                           "Sales Line" := VerkZeile2;

                           MWSTBetragZeile.INIT;
                           MWSTBetragZeile."VAT %" := "Sales Line"."VAT %";
                           MWSTBetragZeile."VAT Base" := "Sales Line".Amount;
                           MWSTBetragZeile."Amount Including VAT" := "Sales Line"."Amount Including VAT";
                           MWSTBetragZeile.InsertLine;

                           IF CurrReport.LANGUAGE = 1031 THEN
                              BEGIN
                                 steuer_text:=MWSTBetragZeile.VATAmountText ;
                              END
                              ELSE
                              BEGIN
                                 steuer_text:='Total V.A.T.';
                              END;


                           // Lead Free
                           {
                           IF "Sales Line".Type="Sales Line".Type::Item THEN
                           BEGIN

                           leadfree_symbol:='';
                           leadfree_artikel.SETFILTER(leadfree_artikel."No.",'%1',"Sales Line"."No.");

                           IF leadfree_artikel.FIND('-') THEN
                              BEGIN

                                IF (leadfree_artikel."Lead Free" = TRUE) AND
                                   ("Sales Line"."Quantity Shipped" <> "Sales Line"."Quantity (Base)") AND
                                   (NOT(leadfree_artikel.Herstellerkurzname = 'HAL') AND
                                    NOT(leadfree_artikel.Herstellerkurzname = 'SYN') AND
                                    NOT(leadfree_artikel.Herstellerkurzname = 'IDT') AND
                                    NOT(leadfree_artikel.Herstellerkurzname = 'PLX') AND
                                    NOT(leadfree_artikel.Herstellerkurzname = 'TDK') AND
                                    NOT(leadfree_artikel.Herstellerkurzname = 'TSC') AND
                                    NOT(leadfree_artikel.Herstellerkurzname = 'JEL') AND
                                    NOT(leadfree_artikel.Herstellerkurzname = 'SIM') AND
                                    NOT(leadfree_artikel.Herstellerkurzname = 'NEX') AND
                                    NOT(leadfree_artikel.Herstellerkurzname = 'LSI') AND
                                    NOT(leadfree_artikel.Herstellerkurzname = 'WML') AND
                                    NOT(leadfree_artikel.Herstellerkurzname = 'SIW') AND
                                    NOT(leadfree_artikel.Herstellerkurzname = 'ACL') AND
                                    NOT(leadfree_artikel.Herstellerkurzname = 'ICP') AND
                                    NOT(leadfree_artikel.Herstellerkurzname = 'RIC') AND
                                    NOT(leadfree_artikel.Herstellerkurzname = 'ICSA') AND
                                    NOT(leadfree_artikel.Herstellerkurzname = 'ICS'))
                                   THEN
                                   BEGIN
                                      leadfree_symbol:='ø';
                                      IF CurrReport.LANGUAGE = 1031 THEN
                                         BEGIN
                                           lead_free_text1 := ' ø Diese Bauteile sind nach Angabe des Herstellers bleifrei.';
                                           lead_free_text2 := 'Bitte beachten Sie gegebenenfalls die neue Bestellbezeichnung.';
                                         END
                                      ELSE
                                         BEGIN
                                           lead_free_text1 := ' ø According to manufacturer these parts are leadfree.';
                                           lead_free_text2 := 'Please note the new part number where applicable.';

                                        END;

                                   END;
                                IF (leadfree_artikel."Lead Free" = TRUE) AND
                                   ("Sales Line"."Quantity Shipped" <> "Sales Line"."Quantity (Base)") AND
                                   ((leadfree_artikel.Herstellerkurzname = 'HAL') OR
                                    (leadfree_artikel.Herstellerkurzname = 'SYN') OR
                                    (leadfree_artikel.Herstellerkurzname = 'IDT') OR
                                    (leadfree_artikel.Herstellerkurzname = 'PLX') OR
                                    (leadfree_artikel.Herstellerkurzname = 'TDK') OR
                                    (leadfree_artikel.Herstellerkurzname = 'TSC') OR
                                    (leadfree_artikel.Herstellerkurzname = 'JEL') OR
                                    (leadfree_artikel.Herstellerkurzname = 'SIM') OR
                                    (leadfree_artikel.Herstellerkurzname = 'NEX') OR
                                    (leadfree_artikel.Herstellerkurzname = 'LSI') OR
                                    (leadfree_artikel.Herstellerkurzname = 'WML') OR
                                    (leadfree_artikel.Herstellerkurzname = 'SIW') OR
                                    (leadfree_artikel.Herstellerkurzname = 'ACL') OR
                                    (leadfree_artikel.Herstellerkurzname = 'ICP') OR
                                    (leadfree_artikel.Herstellerkurzname = 'RIC') OR
                                    (leadfree_artikel.Herstellerkurzname = 'ICSA') OR
                                    (leadfree_artikel.Herstellerkurzname = 'ICS'))
                                   THEN
                                   BEGIN
                                      leadfree_symbol:='øø';
                                      IF CurrReport.LANGUAGE = 1031 THEN
                                         BEGIN
                                            lead_free_text0 := 'øø Diese Bauteile sind nach Angabe des Herstellers RoHS konform.';
                                            lead_free_text2 := 'Bitte beachten Sie gegebenenfalls die neue Bestellbezeichnung.';
                                         END
                                         ELSE
                                         BEGIN
                                            lead_free_text0 := 'øø  According to manufacturer these parts are RoHS compliant.';
                                            lead_free_text2 := 'Please note the new part number where applicable.';
                                         END;
                                   END;

                              END;
                           END;
                           }

                           //20.08.09-ST Andruck, wenn Artikel bleihaltig ist

                           IF "Sales Line".Type="Sales Line".Type::Item THEN
                             BEGIN
                               lead_symbol:='';
                               lead_artikel.SETFILTER(lead_artikel."No.",'%1',"Sales Line"."No.");

                               IF lead_artikel.FINDFIRST THEN
                                 BEGIN
                                   IF (lead_artikel."Lead Free" = FALSE) AND (lead_artikel."Item Tracking Code" = 'DATECODE')
                                   AND ("Sales Line"."Quantity Shipped" <> "Sales Line"."Quantity (Base)") THEN
                                     BEGIN
                                       lead_symbol := 'ø';
                                       IF CurrReport.LANGUAGE = 1031 THEN
                                         BEGIN
                                           lead_text := 'ø Diese Bauteile sind nach Angabe des Herstellers nicht RoHS konform bzw. nicht bleifrei.';
                                         END
                                       ELSE
                                         BEGIN
                                           lead_text := 'ø According to manufacturer these parts are non-RoHS compliant respectively not leadfree.';
                                         END;
                                     END;
                                 END;
                             END;


                            IF v_FER_SPL=FALSE THEN BEGIN
                              IF (("Sales Line"."Manufacturer Code" ='82') OR ("Sales Line"."Manufacturer Code" = '85')) THEN BEGIN
                               v_FER_SPL:=TRUE;
                              END;
                            END;
                         END;

        OnPostDataItem=BEGIN
                         VerkZeile2.DELETEALL;
                       END;

        DataItemLinkReference=SeiteSchleife;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18800;
            SectionHeight=1300;
          }
          CONTROLS
          {
            { 74  ;Shape        ;0    ;0    ;18300;1200  }
            { 78  ;Label        ;16500;200  ;1900 ;400  ;Name=Gesamtpreis;
                                                         HorzAlign=Center;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=[DEU=Gesamtpreis;
                                                                    ENU=Total] }
            { 79  ;Label        ;15000;200  ;1500 ;400  ;Name=Einzelpreis;
                                                         HorzAlign=Center;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=[DEU=Einzelpreis;
                                                                    ENU=Unit Price] }
            { 80  ;Label        ;13300;600  ;1500 ;400  ;Name=land;
                                                         HorzGlue=Left;
                                                         HorzAlign=Center;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=[DEU=land;
                                                                    ENU=Origin] }
            { 81  ;Label        ;13300;200  ;1500 ;400  ;Name=Ursprungs-;
                                                         HorzAlign=Center;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=[DEU=Ursprungs-;
                                                                    ENU=Country of] }
            { 149 ;Label        ;11500;600  ;1900 ;400  ;Name=Versandtermin;
                                                         HorzGlue=Left;
                                                         HorzAlign=Center;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=[DEU=Versandtermin;
                                                                    ENU=Ship Date] }
            { 150 ;Label        ;11500;200  ;1800 ;400  ;Name=Best„tigter;
                                                         HorzAlign=Center;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=[DEU=Best„tigter;
                                                                    ENU="Scheduled "] }
            { 151 ;Label        ;9600 ;600  ;1700 ;400  ;Name=Menge;
                                                         HorzGlue=Left;
                                                         HorzAlign=Center;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=[DEU=Menge;
                                                                    ENU=be delivered] }
            { 152 ;Label        ;9600 ;200  ;1700 ;400  ;Name=Noch zu lief.;
                                                         HorzAlign=Center;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=[DEU=Noch zu lief.;
                                                                    ENU=Quantity to] }
            { 153 ;Label        ;7900 ;200  ;1400 ;400  ;Name=Bestellte;
                                                         HorzAlign=Center;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=[DEU=Bestellte;
                                                                    ENU=Quantity] }
            { 154 ;Label        ;7900 ;600  ;1400 ;400  ;Name=Menge;
                                                         HorzGlue=Left;
                                                         HorzAlign=Center;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=[DEU=Menge;
                                                                    ENU=Ordered] }
            { 155 ;Label        ;2000 ;200  ;5200 ;400  ;Name=Artikel;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=[DEU=Artikel;
                                                                    ENU=Part-No.] }
            { 156 ;Label        ;100  ;200  ;800  ;400  ;Name=Pos.;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=[DEU=Pos.;
                                                                    ENU=Item] }
            { 44  ;TextBox      ;15000;600  ;1500 ;400  ;HorzAlign=Center;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         SourceExpr=waehrung2 }
            { 45  ;TextBox      ;16500;600  ;1900 ;400  ;HorzAlign=Center;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         SourceExpr=waehrung2 }
            { 46  ;Label        ;1100 ;200  ;500  ;400  ;Name=HK;
                                                         FontSize=7;
                                                         FontBold=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=18800;
            SectionHeight=1000;
          }
          CONTROLS
          {
            { 54  ;TextBox      ;15780;577  ;2450 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         CaptionML=DEU=Fortsetzung;
                                                         SourceExpr=ROUND(((VerkZeile2."Outstanding Amount")/(100+mwst)*100) +VerkZeile2. "Inv. Discount Amount",0.01);
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 53  ;Label        ;11300;577  ;4200 ;423  ;ParentControl=54;
                                                         FontSize=9;
                                                         LeaderDots=Yes;
                                                         CaptionML=[DEU=Fortsetzung;
                                                                    ENU=Continuation] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18800;
            SectionHeight=500;
            OnPreSection=BEGIN
                           //CurrReport.SHOWOUTPUT(VerkZeile2.Art = 0);
                           // Unterdckt Artikeltexte wenn eine Artikelzeile nicht berechnet wird
                           vk_zeile.SETFILTER(vk_zeile."Document No.",'%1',VerkZeile2."Document No." );
                           vk_zeile.SETFILTER(vk_zeile."Line No.",'%1',VerkZeile2."Attached to Line No." );
                           IF vk_zeile.FIND('-') THEN
                             BEGIN
                               CurrReport.SHOWOUTPUT(
                                 ((vk_zeile.Type=vk_zeile.Type::Item) AND (vk_zeile."Outstanding Quantity" > 0))
                                 OR
                                 (vk_zeile.Type=0));
                             END
                             ELSE
                             BEGIN
                               IF ((VerkZeile2."Attached to Line No."=0) AND (VerkZeile2.Type=0)) THEN
                               BEGIN
                               CurrReport.SHOWOUTPUT(TRUE);
                               END
                               ELSE
                               BEGIN
                               CurrReport.SHOWOUTPUT(FALSE);
                               END
                             END;
                           //
                         END;

          }
          CONTROLS
          {
            { 55  ;TextBox      ;2006 ;0    ;16194;423  ;FontSize=8;
                                                         SourceExpr="Sales Line".Description }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18800;
            SectionHeight=600;
            OnPreSection=BEGIN
                           sum_netto:=0;
                           CurrReport.SHOWOUTPUT((VerkZeile2.Type =VerkZeile2.Type::"G/L Account") AND (VerkZeile2."Outstanding Quantity">0));
                           IF VerkZeile2.Type = VerkZeile2.Type::"G/L Account" THEN
                             BEGIN
                               sum_restauftragsbestand:=sum_restauftragsbestand+ROUND(((VerkZeile2."Outstanding Amount")/(100+
                               VerkZeile2."VAT %")*100),0.01);
                               sum_netto:=ROUND(((VerkZeile2."Outstanding Amount")/(100+VerkZeile2."VAT %")*100),0.01);
                               sum_mwstbetrag:=sum_mwstbetrag+ROUND(((sum_netto)/(100)*VerkZeile2."VAT %"),0.00001);
                                SumPorto:=VerkZeile2.Amount;
                             END;
                         END;

          }
          CONTROLS
          {
            { 56  ;TextBox      ;2006 ;177  ;5200 ;423  ;FontSize=8;
                                                         SourceExpr="Sales Line".Description }
            { 57  ;TextBox      ;7300 ;177  ;1700 ;400  ;FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr="Sales Line"."Outstanding Quantity" }
            { 59  ;TextBox      ;14700;177  ;1500 ;400  ;FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr="Sales Line"."Unit Price";
                                                         AutoFormatType=2;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 61  ;TextBox      ;16330;177  ;1900 ;400  ;FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=ROUND(((VerkZeile2."Outstanding Amount")/(100+VerkZeile2."VAT %")*100)+"Sales Line"."Inv. Discount Amount",0.01);
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 58  ;Shape        ;0    ;0    ;18300;100  ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18800;
            SectionHeight=0;
            KeepWithNext=No;
          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18800;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(VerkZeile2.Type = VerkZeile2.Type::Resource);
                         END;

          }
          CONTROLS
          {
            { 69  ;TextBox      ;0    ;177  ;1000 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Sales Line"."No." }
            { 70  ;TextBox      ;2006 ;177  ;5200 ;423  ;FontSize=8;
                                                         SourceExpr="Sales Line".Description }
            { 71  ;TextBox      ;8820 ;177  ;1470 ;423  ;FontSize=9;
                                                         BlankZero=Yes;
                                                         SourceExpr="Sales Line".Quantity }
            { 72  ;TextBox      ;10500;177  ;1050 ;423  ;FontSize=9;
                                                         SourceExpr="Sales Line"."Unit of Measure" }
            { 73  ;TextBox      ;11760;177  ;2100 ;423  ;FontSize=9;
                                                         BlankZero=Yes;
                                                         SourceExpr="Sales Line"."Unit Price";
                                                         AutoFormatType=2;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 75  ;TextBox      ;15540;177  ;2520 ;423  ;FontSize=9;
                                                         BlankZero=Yes;
                                                         SourceExpr=ROUND(((VerkZeile2."Outstanding Amount")/(100+mwst)*100),0.01);
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 68  ;Shape        ;0    ;0    ;18300;100  ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=18800;
            SectionHeight=1023;
          }
          CONTROLS
          {
            { 84  ;TextBox      ;15710;600  ;2520 ;423  ;FontSize=9;
                                                         CaptionML=DEU=Fortsetzung;
                                                         SourceExpr=ROUND(((VerkZeile2."Outstanding Amount")/(100+mwst)*100)+VerkZeile2."Inv. Discount Amount",0.01);
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 83  ;Label        ;11200;600  ;4200 ;423  ;ParentControl=84;
                                                         FontSize=9;
                                                         LeaderDots=Yes;
                                                         CaptionML=[DEU=Fortsetzung;
                                                                    ENU=To Be Continued] }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18800;
            SectionHeight=0;
          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18800;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(VerkZeile2."Inv. Discount Amount" <> 0);
                         END;

          }
          CONTROLS
          {
            { 86  ;TextBox      ;15780;0    ;2450 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         CaptionML=DEU=Rechn.-Rabatt Betrag;
                                                         SourceExpr=ROUND(-VerkZeile2."Inv. Discount Amount",0.01);
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 85  ;Label        ;11300;0    ;4200 ;423  ;ParentControl=86;
                                                         FontSize=9;
                                                         CaptionML=[DEU=Rechn.-Rabatt Betrag;
                                                                    ENU=invoice rebate] }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18800;
            SectionHeight=800;
            OnPreSection=BEGIN
                            CurrReport.SHOWOUTPUT(lead_free_text0 <>'');
                         END;

          }
          CONTROLS
          {
            { 199 ;TextBox      ;1400 ;400  ;10100;400  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         MultiLine=Yes;
                                                         SourceExpr=lead_free_text0 }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18800;
            SectionHeight=800;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(lead_free_text1 <>'');
                         END;

          }
          CONTROLS
          {
            { 31  ;TextBox      ;1400 ;400  ;10100;400  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         MultiLine=Yes;
                                                         SourceExpr=lead_free_text1 }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18800;
            SectionHeight=700;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((lead_free_text1 <>'')OR (lead_free_text0 <> ''));
                         END;

          }
          CONTROLS
          {
            { 22  ;TextBox      ;1800 ;0    ;10100;400  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         MultiLine=Yes;
                                                         SourceExpr=lead_free_text2 }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18800;
            SectionHeight=956;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(lead_text <>'');
                         END;

          }
          CONTROLS
          {
            { 1140013;TextBox   ;1426 ;344  ;14015;400  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         MultiLine=Yes;
                                                         SourceExpr=lead_text }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18800;
            SectionHeight=185;
          }
          CONTROLS
          {
            { 203 ;Shape        ;0    ;85   ;18300;100  ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18800;
            SectionHeight=475;
            OnPreSection=BEGIN
                            CurrReport.SHOWOUTPUT(v_FER_SPL=FALSE);
                         END;

          }
          CONTROLS
          {
            { 19  ;Shape        ;0    ;375  ;18300;100  ;ShapeStyle=HorzLine }
            { 21  ;Label        ;0    ;0    ;18300;350  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=[DEU=Diese Waren wurden NICHT in der EU hergestellt, sie entsprechen NICHT den Pr„ferenzregeln;
                                                                    ENU=These products were not manufactured in the European Union.] }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18800;
            SectionHeight=1918;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(Debito."VAT Bus. Posting Group" <> 'HAN_AUSL' );
                         END;

          }
          CONTROLS
          {
            { 76  ;TextBox      ;11174;192  ;3500 ;423  ;FontSize=9;
                                                         FontBold=No;
                                                         SourceExpr=TotalText }
            { 51  ;TextBox      ;11174;615  ;3500 ;423  ;FontSize=9;
                                                         SourceExpr=steuer_text }
            { 77  ;TextBox      ;11174;1292 ;3500 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=TotalInklMWStText }
            { 40  ;TextBox      ;17174;192  ;1100 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         SourceExpr=waehrung2 }
            { 41  ;TextBox      ;17174;592  ;1100 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         SourceExpr=waehrung2 }
            { 43  ;TextBox      ;17174;1292 ;1100 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=waehrung2 }
            { 47  ;TextBox      ;14774;192  ;2400 ;423  ;FontSize=9;
                                                         FontBold=No;
                                                         SourceExpr=sum_restauftragsbestand;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 165 ;TextBox      ;14774;592  ;2400 ;423  ;FontSize=9;
                                                         FontBold=No;
                                                         SourceExpr=sum_mwstbetrag;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 167 ;TextBox      ;14774;1292 ;2400 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=(sum_restauftragsbestand+sum_mwstbetrag);
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18800;
            SectionHeight=824;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(Debito."VAT Bus. Posting Group" = 'HAN_AUSL' );
                         END;

          }
          CONTROLS
          {
            { 201 ;TextBox      ;17200;271  ;1100 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=waehrung2 }
            { 202 ;TextBox      ;14800;271  ;2400 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=sum_restauftragsbestand;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 204 ;TextBox      ;11200;271  ;3500 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=TotalText }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=4;
        DataItemTable=Table27;
        OnPreDataItem=BEGIN
                        IF "Sales Line"."Promised Delivery Date" = (31122053D) THEN
                          IF CurrReport.LANGUAGE = 1031 THEN
                            BEGIN
                               liefert:='Abruf';
                            END
                           ELSE
                            BEGIN
                               liefert:='on call';
                            END;

                        IF "Sales Line"."Promised Delivery Date"= (31122055D) THEN
                        BEGIN
                          IF CurrReport.LANGUAGE = 1031 THEN
                            BEGIN
                               liefert:='folgt';
                            END
                           ELSE
                            BEGIN
                               liefert:='To Follow';
                            END;



                        END;
                      END;

        OnAfterGetRecord=BEGIN
                           IF "Sales Line".Type = "Sales Line".Type::Item THEN
                             BEGIN
                               IF "Sales Line"."VAT %" > 0 THEN         //sonst werden die Textzeilen mit bercksichtigt
                                 BEGIN
                                   mwst:="Sales Line"."VAT %"
                                 END
                               ELSE
                                 BEGIN
                                   mwst:=0;
                                 END;
                             END;

                           sum_restauftragsbestand:=sum_restauftragsbestand+ROUND((("Sales Line"."Outstanding Amount")/(100+mwst)*100),0.01);

                           // TOPAS
                           IF "Sales Line"."Blanket Order No." <> '' THEN
                           BEGIN
                           rahmenauftragsnummer:="Sales Line"."Blanket Order No.";
                           rahmen:=TRUE;
                           END;
                           // TOPAS
                         END;

        OnPostDataItem=BEGIN
                         liefert:='';
                       END;

        DataItemLinkReference=Sales Line;
        DataItemLink=No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18800;
            SectionHeight=1200;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((VerkZeile2.Type = VerkZeile2.Type::Item) AND (VerkZeile2."Outstanding Quantity">0) AND
                           ("Sales Line"."Promised Delivery Date" = (31122055D)));

                           IF ((VerkZeile2.Type = VerkZeile2.Type::Item) AND (VerkZeile2."Outstanding Quantity">0) AND
                           ("Sales Line"."Promised Delivery Date" = (31122055D))) THEN
                           BEGIN
                             sum_mwstbetrag:=sum_mwstbetrag+ROUND(((VerkZeile2."Outstanding Amount")/(100+VerkZeile2."VAT %")
                             *VerkZeile2."VAT %"),0.00001);

                           END;
                         END;

          }
          CONTROLS
          {
            { 166 ;TextBox      ;14700;200  ;1500 ;400  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr="Sales Line"."Unit Price";
                                                         AutoFormatType=2;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 168 ;TextBox      ;13500;200  ;1000 ;400  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         SourceExpr=Item."Country/Region of Origin Code" }
            { 169 ;TextBox      ;11600;200  ;1700 ;400  ;Visible=Yes;
                                                         HorzAlign=Center;
                                                         FontSize=8;
                                                         SourceExpr=liefert }
            { 170 ;TextBox      ;9700 ;200  ;1700 ;400  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr="Sales Line"."Outstanding Quantity" }
            { 171 ;TextBox      ;7800 ;200  ;1700 ;400  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr="Sales Line".Quantity }
            { 172 ;TextBox      ;2006 ;700  ;9100 ;500  ;FontSize=8;
                                                         SourceExpr="Sales Line".Description }
            { 174 ;TextBox      ;2006 ;200  ;5994 ;500  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Sales Line"."Artikelnr. 2" }
            { 175 ;Shape        ;0    ;0    ;18300;100  ;ShapeStyle=HorzLine }
            { 176 ;TextBox      ;1000 ;200  ;759  ;500  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         SourceExpr=Item.Herstellerkurzname }
            { 177 ;TextBox      ;0    ;200  ;1000 ;500  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Sales Line"."Line No." }
            { 162 ;TextBox      ;16300;200  ;1900 ;400  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         CaptionML=DEU=Betrag;
                                                         DecimalPlaces=2:0;
                                                         Numeric=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=ROUND((("Sales Line"."Outstanding Amount")/(100+mwst)*100),0.01);
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 1140010;TextBox   ;1732 ;200  ;300  ;500  ;SourceExpr=lead_symbol }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18800;
            SectionHeight=1200;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((VerkZeile2.Type = VerkZeile2.Type::Item) AND (VerkZeile2."Outstanding Quantity">0) AND
                           (VerkZeile2."Promised Delivery Date" = (31122053D)));

                           IF ((VerkZeile2.Type = VerkZeile2.Type::Item) AND (VerkZeile2."Outstanding Quantity">0) AND
                           (VerkZeile2."Promised Delivery Date" = (31122053D))) THEN
                           BEGIN
                             sum_mwstbetrag:=sum_mwstbetrag+ROUND(((VerkZeile2."Outstanding Amount")/(100+VerkZeile2."VAT %")
                             *VerkZeile2."VAT %"),0.00001);

                           END;
                         END;

          }
          CONTROLS
          {
            { 48  ;TextBox      ;14700;200  ;1500 ;400  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr="Sales Line"."Unit Price";
                                                         AutoFormatType=2;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 62  ;TextBox      ;13500;200  ;1000 ;400  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         SourceExpr=Item."Country/Region of Origin Code" }
            { 65  ;TextBox      ;9700 ;200  ;1700 ;400  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr="Sales Line"."Outstanding Quantity" }
            { 66  ;TextBox      ;7800 ;200  ;1700 ;400  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr="Sales Line".Quantity }
            { 67  ;TextBox      ;2006 ;673  ;9100 ;500  ;FontSize=8;
                                                         SourceExpr="Sales Line".Description }
            { 82  ;TextBox      ;2006 ;200  ;5994 ;500  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Sales Line"."Artikelnr. 2" }
            { 87  ;TextBox      ;1000 ;200  ;759  ;500  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         SourceExpr=Item.Herstellerkurzname }
            { 99  ;TextBox      ;0    ;200  ;1000 ;500  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Sales Line"."Line No." }
            { 104 ;Shape        ;0    ;0    ;18300;100  ;ShapeStyle=HorzLine }
            { 64  ;TextBox      ;11600;200  ;1700 ;400  ;Visible=Yes;
                                                         HorzAlign=Center;
                                                         FontSize=8;
                                                         SourceExpr=liefert }
            { 159 ;TextBox      ;16300;200  ;1900 ;400  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         CaptionML=DEU=Betrag;
                                                         DecimalPlaces=2:0;
                                                         Numeric=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=ROUND((("Sales Line"."Outstanding Amount")/(100+mwst)*100),0.01);
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 1140011;TextBox   ;1732 ;200  ;300  ;500  ;SourceExpr=lead_symbol }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18800;
            SectionHeight=1200;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((VerkZeile2.Type = VerkZeile2.Type::Item) AND (VerkZeile2."Outstanding Quantity">0) AND
                           (VerkZeile2."Promised Delivery Date" < (31122053D)));

                           IF ((VerkZeile2.Type = VerkZeile2.Type::Item) AND (VerkZeile2."Outstanding Quantity">0) AND
                           (VerkZeile2."Promised Delivery Date" < (31122053D))) THEN
                           BEGIN
                             sum_mwstbetrag:=sum_mwstbetrag+ROUND(((VerkZeile2."Outstanding Amount")/(100+VerkZeile2."VAT %")
                             *VerkZeile2."VAT %"),0.00001);

                           END;
                         END;

          }
          CONTROLS
          {
            { 20  ;TextBox      ;2006 ;700  ;9100 ;500  ;FontSize=8;
                                                         SourceExpr="Sales Line".Description }
            { 25  ;TextBox      ;2006 ;200  ;5994 ;500  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Sales Line"."Artikelnr. 2" }
            { 26  ;TextBox      ;14700;200  ;1500 ;400  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr="Sales Line"."Unit Price";
                                                         AutoFormatType=2;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 32  ;TextBox      ;13500;200  ;1000 ;400  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         SourceExpr=Item."Country/Region of Origin Code" }
            { 34  ;TextBox      ;9700 ;200  ;1700 ;400  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr="Sales Line"."Outstanding Quantity" }
            { 35  ;TextBox      ;7800 ;200  ;1700 ;400  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr="Sales Line".Quantity }
            { 37  ;Shape        ;0    ;0    ;18300;100  ;ShapeStyle=HorzLine }
            { 39  ;TextBox      ;1000 ;200  ;759  ;500  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         SourceExpr=Item.Herstellerkurzname }
            { 42  ;TextBox      ;0    ;200  ;1000 ;500  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Sales Line"."Line No." }
            { 33  ;TextBox      ;11600;200  ;1700 ;400  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr="Sales Line"."Promised Delivery Date" }
            { 161 ;TextBox      ;16300;200  ;1900 ;400  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         CaptionML=DEU=Betrag;
                                                         DecimalPlaces=2:0;
                                                         Numeric=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=ROUND((("Sales Line"."Outstanding Amount")/(100+mwst)*100),0.01);
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 1140012;TextBox   ;1732 ;200  ;300  ;500  ;SourceExpr=lead_symbol }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18800;
            SectionHeight=500;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((VerkZeile2."Description 2" <> '') AND (VerkZeile2."Outstanding Quantity">0));
                         END;

          }
          CONTROLS
          {
            { 63  ;TextBox      ;2006 ;0    ;9100 ;500  ;FontSize=8;
                                                         SourceExpr="Sales Line"."Description 2" }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18800;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(((Item."Tariff No." <>'')AND (VerkZeile2."Outstanding Quantity">0)) OR
                                                ((Item."ECCN-Nr." <>'')AND (VerkZeile2."Outstanding Quantity">0)));
                         END;

          }
          CONTROLS
          {
            { 208 ;TextBox      ;2006 ;0    ;6930 ;423  ;FontSize=8;
                                                         SourceExpr='Warentarif-Nr.: '+ Item."Tariff No." }
            { 1140026;TextBox   ;9081 ;0    ;6930 ;423  ;FontSize=8;
                                                         SourceExpr='ECCN-Nr.: '+ Item."ECCN-Nr." }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18800;
            SectionHeight=300;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((VerkZeile2.Type = VerkZeile2.Type::Item) AND (VerkZeile2."Outstanding Quantity">0) AND
                           ("Sales Line"."Cross-Reference No." <> ''));
                         END;

          }
          CONTROLS
          {
            { 189 ;Label        ;1980 ;0    ;2800 ;300  ;Name=Ihre Artikelnummer:;
                                                         CaptionML=[DEU=Ihre Artikelnummer:;
                                                                    ENU=Your part number:] }
            { 190 ;TextBox      ;4780 ;0    ;5200 ;300  ;HorzAlign=Left;
                                                         SourceExpr="Sales Line"."Cross-Reference No." }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18800;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(((Item.NCNR=TRUE) AND (VerkZeile2."Outstanding Quantity">0)) OR ((Item."Manufacturer Code"='00')
                           AND (VerkZeile2."Outstanding Quantity">0)));
                         END;

          }
          CONTROLS
          {
            { 209 ;Label        ;2006 ;0    ;15800;423  ;Name=NCNR;
                                                         HorzAlign=Left;
                                                         FontSize=8;
                                                         CaptionML=[DEU=Dieses Bauteil ist nicht stornier- und nicht retournierbar!;
                                                                    ENU=This part is non-cancelable and non-returnable!] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18800;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((VerkZeile2."VAT Prod. Posting Group"='13B2') AND (VerkZeile2."Outstanding Quantity">0));
                         END;

          }
          CONTROLS
          {
            { 1140016;Label     ;2837 ;190  ;8773 ;423  ;Name=NCNR;
                                                         HorzAlign=Left;
                                                         FontSize=8;
                                                         CaptionML=[DEU=Steuerschuldbergang gem„á õ 13b Abs.2 Nr.10 i.V.m. Abs.5 UStG !;
                                                                    ENU=This part is non-cancelable and non-returnable!] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table44;
        DataItemTableView=SORTING(Document Type,No.,Line No.);
        DataItemLinkReference=Sales Header;
        DataItemLink=Document Type=FIELD(Document Type),
                     No.=FIELD(No.);
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=MWStZ„hler;
        OnPreDataItem=BEGIN
                        IF MWSTBetragZeile.COUNT <= 1 THEN
                          CurrReport.BREAK;
                        SETRANGE(Number,1,MWSTBetragZeile.COUNT);
                        CurrReport.CREATETOTALS(MWSTBetragZeile."VAT Base",MWSTBetragZeile."VAT Amount");
                      END;

        OnAfterGetRecord=BEGIN
                           MWSTBetragZeile.GetLine(Number);
                         END;

        DataItemLinkReference=SeiteSchleife;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18800;
            SectionHeight=2115;
            OnPreSection=BEGIN
                            // Diese Einschr„nkung des Reports wieder entfernen, wenn keine Zeilen mit 16%MWSt vorhanden sind.
                            // Dies gilt auch fr die n„chsten Zeilen des Reports.

                                  CurrReport.SHOWOUTPUT("Sales Header"."No.">'AU121561');
                         END;

          }
          CONTROLS
          {
            { 93  ;Label        ;0    ;846  ;2100 ;846  ;ParentControl=105;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 94  ;Label        ;2310 ;846  ;2520 ;846  ;ParentControl=106;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 95  ;Label        ;5040 ;846  ;2520 ;846  ;ParentControl=107;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 52  ;Label        ;0    ;0    ;6300 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=DEU=MwSt. Betrag Spezifikation }
          }
           }
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=18800;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Sales Header"."No.">'AU121561');
                         END;

          }
          CONTROLS
          {
            { 101 ;Label        ;0    ;0    ;2100 ;423  ;ParentControl=102;
                                                         FontSize=9;
                                                         LeaderDots=Yes }
            { 102 ;TextBox      ;2310 ;0    ;2520 ;423  ;FontSize=9;
                                                         CaptionML=DEU=Fortsetzung;
                                                         SourceExpr=MWSTBetragZeile."VAT Base";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
            { 103 ;TextBox      ;5040 ;0    ;2520 ;423  ;FontSize=9;
                                                         SourceExpr=MWSTBetragZeile."VAT Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18800;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Sales Header"."No.">'AU121561');
                         END;

          }
          CONTROLS
          {
            { 105 ;TextBox      ;0    ;0    ;2100 ;423  ;FontSize=9;
                                                         CaptionML=DEU=MWSt %;
                                                         SourceExpr=MWSTBetragZeile."VAT %" }
            { 106 ;TextBox      ;2310 ;0    ;2520 ;423  ;FontSize=9;
                                                         CaptionML=DEU=MWSt Bemessungsgrundlage;
                                                         SourceExpr=MWSTBetragZeile."VAT Base";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
            { 107 ;TextBox      ;5040 ;0    ;2520 ;423  ;FontSize=9;
                                                         CaptionML=DEU=MWSt Betrag;
                                                         SourceExpr=MWSTBetragZeile."VAT Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=18800;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Sales Header"."No.">'AU121561');
                         END;

          }
          CONTROLS
          {
            { 109 ;Label        ;0    ;423  ;2100 ;423  ;ParentControl=110;
                                                         FontSize=9;
                                                         LeaderDots=Yes }
            { 110 ;TextBox      ;2310 ;423  ;2520 ;423  ;FontSize=9;
                                                         CaptionML=DEU=Fortsetzung;
                                                         SourceExpr=MWSTBetragZeile."VAT Base";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
            { 111 ;TextBox      ;5040 ;423  ;2520 ;423  ;FontSize=9;
                                                         SourceExpr=MWSTBetragZeile."VAT Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18800;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Sales Header"."No.">'AU121561');
                         END;

          }
          CONTROLS
          {
            { 113 ;Label        ;0    ;423  ;2100 ;423  ;ParentControl=114;
                                                         FontSize=9;
                                                         FontBold=Yes }
            { 114 ;TextBox      ;2310 ;423  ;2520 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=DEU=Total;
                                                         SourceExpr=MWSTBetragZeile."VAT Base";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
            { 115 ;TextBox      ;5040 ;423  ;2520 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=MWSTBetragZeile."VAT Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=Total;
        DataItemLinkReference=SeiteSchleife;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18800;
            SectionHeight=1800;
          }
          CONTROLS
          {
            { 117 ;Label        ;0    ;400  ;4200 ;423  ;ParentControl=118;
                                                         FontSize=9;
                                                         CaptionML=[DEU=Zahlungsbedingung;
                                                                    ENU="Payment Terms "] }
            { 118 ;TextBox      ;4410 ;400  ;10500;423  ;FontSize=9;
                                                         CaptionML=DEU=Zahlungsbedingung;
                                                         SourceExpr=ZlgBed.Description }
            { 119 ;Label        ;0    ;823  ;4200 ;423  ;ParentControl=120;
                                                         FontSize=9;
                                                         CaptionML=[DEU=Lieferbedingung;
                                                                    ENU=Delivery Terms] }
            { 120 ;TextBox      ;4410 ;823  ;10500;423  ;FontSize=9;
                                                         CaptionML=DEU=Lieferbedingung;
                                                         SourceExpr=LieferBed.Description }
            { 112 ;Label        ;0    ;1200 ;4200 ;423  ;FontSize=9;
                                                         CaptionML=[DEU=Versandart;
                                                                    ENU=Shipping] }
            { 1140008;TextBox   ;4400 ;1200 ;10500;423  ;FontSize=9;
                                                         CaptionML=DEU=Lieferbedingung;
                                                         SourceExpr=Account }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=Total2;
        OnPreDataItem=BEGIN
                        IF NOT LiefAdrAnzeigen THEN
                          CurrReport.BREAK;
                      END;

        DataItemLinkReference=SeiteSchleife;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18800;
            SectionHeight=1000;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(LiefAdrAnzeigen);
                         END;

          }
          CONTROLS
          {
            { 121 ;Label        ;0    ;577  ;6300 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[DEU=Lieferadresse:;
                                                                    ENU=Shipping Address:] }
            { 88  ;Label        ;8800 ;577  ;6300 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[DEU=Rechnungsadresse:;
                                                                    ENU=Billing Address:] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18800;
            SectionHeight=400;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Sales Header"."Sell-to Customer No." <> "Sales Header"."Bill-to Customer No.");
                         END;

          }
          CONTROLS
          {
            { 123 ;TextBox      ;3360 ;0    ;2100 ;300  ;HorzAlign=Left;
                                                         FontSize=7;
                                                         SourceExpr="Sales Header"."Sell-to Customer No." }
            { 122 ;Label        ;0    ;0    ;3150 ;300  ;ParentControl=123;
                                                         FontSize=9 }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18800;
            SectionHeight=2400;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(LiefAdrAnzeigen);
                         END;

          }
          CONTROLS
          {
            { 50  ;TextBox      ;0    ;2100 ;6400 ;300  ;FontSize=7;
                                                         SourceExpr=LieferAnAdr[8] }
            { 49  ;TextBox      ;0    ;1800 ;6400 ;262  ;FontSize=7;
                                                         SourceExpr=LieferAnAdr[7] }
            { 129 ;TextBox      ;0    ;1500 ;6400 ;285  ;FontSize=7;
                                                         SourceExpr=LieferAnAdr[6] }
            { 128 ;TextBox      ;0    ;1200 ;6400 ;300  ;FontSize=7;
                                                         SourceExpr=LieferAnAdr[5] }
            { 127 ;TextBox      ;0    ;900  ;6400 ;300  ;FontSize=7;
                                                         SourceExpr=LieferAnAdr[4] }
            { 126 ;TextBox      ;0    ;600  ;6400 ;300  ;FontSize=7;
                                                         SourceExpr=LieferAnAdr[3] }
            { 125 ;TextBox      ;0    ;300  ;6400 ;277  ;FontSize=7;
                                                         SourceExpr=LieferAnAdr[2] }
            { 124 ;TextBox      ;0    ;0    ;6400 ;300  ;FontSize=7;
                                                         SourceExpr=LieferAnAdr[1] }
            { 173 ;TextBox      ;8800 ;2100 ;7500 ;300  ;FontSize=7;
                                                         SourceExpr=DebAdr[8] }
            { 178 ;TextBox      ;8800 ;1800 ;7500 ;300  ;FontSize=7;
                                                         SourceExpr=DebAdr[7] }
            { 179 ;TextBox      ;8800 ;1500 ;7500 ;300  ;FontSize=7;
                                                         SourceExpr=DebAdr[6] }
            { 180 ;TextBox      ;8800 ;1200 ;7500 ;300  ;FontSize=7;
                                                         SourceExpr=DebAdr[5] }
            { 181 ;TextBox      ;8800 ;900  ;7500 ;300  ;FontSize=7;
                                                         SourceExpr=DebAdr[4] }
            { 182 ;TextBox      ;8800 ;600  ;7500 ;300  ;FontSize=7;
                                                         SourceExpr=DebAdr[3] }
            { 183 ;TextBox      ;8800 ;300  ;7500 ;300  ;FontSize=7;
                                                         SourceExpr=DebAdr[2] }
            { 184 ;TextBox      ;8800 ;0    ;7500 ;300  ;FontSize=7;
                                                         SourceExpr=DebAdr[1] }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=5060;
      Height=440;
      SaveValues=No;
    }
    CONTROLS
    {
      { 1   ;TextBox      ;3410 ;0    ;1650 ;440  ;InPage=-1;
                                                   CaptionML=DEU=Anzahl Kopien;
                                                   SourceExpr=AnzKopien }
      { 21  ;Label        ;0    ;0    ;3300 ;440  ;ParentControl=1;
                                                   InPage=-1 }
    }
  }
  CODE
  {
    VAR
      waehrung@1140000 : Code[10];
      waehrung2@1140001 : Code[10];
      FIBUEinrichtung@1140002 : Record 98;
      LieferBed@1140003 : Record 10;
      ZlgBed@1140004 : Record 3;
      Deb@1140005 : Record 18;
      Geb@1140006 : Record 286;
      suchbe@1140007 : Record 27;
      VerkEinkPerson@1140008 : Record 13;
      Firmendaten@1140009 : Record 79;
      MWSTBetragZeile@1140010 : TEMPORARY Record 290;
      "UnsereKontonr."@1140011 : Record 18;
      VerkZeile2@1140012 : TEMPORARY Record 37;
      language@1140043 : Record 8;
      VerkDruckZ„hler@1140013 : Codeunit 313;
      FormatAdr@1140014 : Codeunit 365;
      VerkBuchen@1140015 : Codeunit 80;
      DebAdr@1140016 : ARRAY [8] OF Text[50];
      LieferAnAdr@1140017 : ARRAY [8] OF Text[50];
      FirmaAdr@1140018 : ARRAY [8] OF Text[50];
      Verk„uferText@1140019 : Text[30];
      MWStNrText@1140020 : Text[30];
      ReferenzText@1140021 : Text[30];
      TotalText@1140022 : Text[50];
      TotalInklMWStText@1140023 : Text[50];
      MehrZeilen@1140024 : Boolean;
      eingabe@1140067 : Integer;
      AnzKopien@1140025 : Integer;
      AnzKopien_sich@1140065 : Integer;
      AnzSchleifen@1140026 : Integer;
      KopieText@1140027 : Text[30];
      LiefAdrAnzeigen@1140028 : Boolean;
      i@1140029 : Integer;
      liefert@1140031 : Code[10];
      liefert2@1140032 : Date;
      mwst@1140033 : Decimal;
      „nderung@1140034 : Text[30];
      sum_restauftragsbestand@1140035 : Decimal;
      sum_mwstbetrag@1140041 : Decimal;
      sum_netto@1140042 : Decimal;
      AnzPorto@1140036 : Decimal;
      SumPorto@1140037 : Decimal;
      VerkAdr@1140038 : ARRAY [8] OF Text[50];
      kunde@1140044 : Record 18;
      rahmenauftragsnummer@1140045 : Code[20];
      rahmenauftr„ge@1140046 : Record 36;
      rahmen@1140047 : Boolean;
      lead_free_text0@1140048 : Text[80];
      lead_free_text1@1140049 : Text[80];
      leadfree_symbol@1140050 : Text[3];
      leadfree_artikel@1140051 : Record 27;
      lead_artikel@1140069 : Record 27;
      lead_text@1140070 : Text[120];
      lead_symbol@1140071 : Text[3];
      lead_free_text2@1140052 : Text[80];
      var_steuernr1@1140053 : Text[20];
      var_steuernr2@1140054 : Text[20];
      ansp_anrede@1140055 : Text[30];
      ansp_telefon@1140056 : Text[30];
      ansp_fax@1140057 : Text[30];
      steuer_text@1140058 : Text[30];
      seite@1140059 : Text[30];
      vk_zeile@1140060 : Record 37;
      Artikel@1140061 : Record 27;
      Account@1140062 : Text[100];
      "Printer selection"@1140063 : Record 78;
      pdf@1140064 : Boolean;
      k@1140074 : Integer;
      counter@1140076 : Integer;
      andruck@1140075 : ARRAY [9] OF Text[80];
      n„chste_lief_woche@1140030 : Text[30];
      n„chste_lief_jahr@1140039 : Text[30];
      n„chste_lief_tab@1140040 : Record 37;
      v_FER_SPL@1140066 : Boolean;

    PROCEDURE AndruckFeldPrfen@1140000() : Integer;
    VAR
      nr@1140000 : Integer;
    BEGIN
      FOR nr:= 1 TO 8 DO
        BEGIN
          IF andruck[nr] = '' THEN
            EXIT(nr)
          ELSE
            BEGIN
              IF nr > 7 THEN
                BEGIN
                  MESSAGE('Achtung Warnhinweis %1 konnte nicht auf der AB-Kopie angedruckt werden.\'+
                          'Wenden Sie sich bitte an Ihren Systemverwalter!',nr + counter);
                  counter += 1;
                  EXIT(8);
                END;
            END;
        END;
    END;

    BEGIN
    END.
  }
}

